---
layout: default
title: 2. Docker 핵심 명령어 실습 가이드
parent: 8월 1일
nav_order: 3
---

# 2025년 8월 1일 교육 내용
도커(docker)

Docker Hub(도커 앱 스토어)에서 Docker가 공식적으로 관리하고 보증하는 '공식(Official)' 우분투(ubuntu) 이미지만을 검색하라
docker search -f is-official=true ubuntu

## 호스트 터미널

제일 필요함
run : Create and run a new container from an image
       이미지를 바탕으로 새로운 컨테이너를 만들고 바로 실행하는 가장 기본적인 명령어
	옵션
	-d : Run container in background and print
      		컨테이너를 백그라운드에서 실행시킵니다. 웹 서버처럼 계속 켜져 있어야 하는 서비스에 사용합니다.
	-i : Keep STDIN open even if not attached
	-t : Allocate a pseudo-TTY

exec : Execute a command in a running container
         이미 실행 중인 컨테이너 안으로 들어가 추가적인 명령어를 실행할 때 사용합니다. 
	 run과 달리 새로운 컨테이너를 만들지 않습니다.

ps : List containers
      현재 실행 중인 컨테이너의 목록을 보여줍니다. 
      (-a 옵션을 추가하면 멈춰있는 컨테이너까지 모두 보여줍니다.)

images :  List images
             내 컴퓨터에 다운로드된 이미지들의 목록을 보여줍니다

search : Search Docker Hub for images
	    Docker Hub(도커 앱 스토어)에서 원하는 이미지를 검색할 때 사용


docker pull ubuntu:latest
	명령어 분석
		docker pull: 원격 저장소에서 이미지를 가져오는(다운로드하는) 명령어입니다.
		ubuntu: 다운로드할 이미지의 이름입니다.
		:latest: 이미지의 **태그(Tag)**로, 보통 해당 이미지의 가장 최신 안정화 버전을 의미합니다. 만약 
		:22.04 처럼 특정 버전을 지정하면 해당 버전의 이미지를 다운로드합니다

docker run -it ubuntu:latest
	명령어 분석
		docker run: 새로운 컨테이너를 생성하고 실행합니다.
		-it: -i와 -t 옵션을 합친 것입니다.
		-i (Interactive): 키보드 입력을 컨테이너로 전달하여 상호작용이 가능하게 합니다.
		-t (TTY): 컨테이너에 가상 터미널 화면을 할당하여 실제 셸처럼 보이게 합니다.
		ubuntu:latest: 컨테이너를 만들 재료가 되는 이미지입니다.

hostname
cat /etc/hosts
hostname -i

docker ps -a
	명령어 분석
		docker ps: 기본적으로 실행 중인 컨테이너만 보여주는 명령어입니다.
		-a (또는 --all): 이 옵션을 추가하면 중지되거나 종료된 컨테이너까지 포함하여 모든 컨테이너를 보여줍니다.

docker start <컨테이너 이름>
	예 ) docker start 7600fc4bd5a5 
	명령어는 멈춰있는(stopped) 컨테이너를 다시 시작시키는 역할

docker ps -a

docker exec -it <컨테이너 이름> /bin/bash
	예 ) docker exec -it 7600fc4bd5a5 /bin/bash
	명령어는 이미 실행 중인 컨테이너 안에 접속하여, 명령어를 직접 입력할 수 있는 새로운 
	대화형 셸(터미널)을 여는 가장 표준적인 방법
	명령어 분석
		docker exec: 실행 중인 컨테이너 내부에서 명령어를 실행합니다.
		-it: 키보드 입력을 가능하게 하고(-i), 터미널 화면을 제공(-t)하여 실제 셸처럼 상호작용할 수 있게 합니다.
		/bin/bash: 컨테이너 안에서 실행할 프로그램입니다. 여기서는 Bash 셸을 실행하라는 의미입니다.
	
docker stop <컨테이너 이름>
	예 ) docker stop 7600fc4bd5a5
	명령어는 실행 중인 컨테이너를 안전하게 중지시키는 역할


ubuntu@docker:~$ docker ps -a
	역할: "내 컴퓨터에 있는 컨테이너 목록 전부 보여줘."
ubuntu@docker:~$ docker rm 7600fc4bd5a5
	역할: "ID가 7600fc4bd5a5인 컨테이너를 삭제해."
ubuntu@docker:~$ docker images
	역할: "내 컴퓨터에 다운로드된 이미지(설계도) 목록 보여줘."

docker run -dit --name ubuntu10 ubuntu:latest
	명령어 분석
		-dit: 세 가지 옵션을 합친 것입니다.
		-d: 컨테이너를 **백그라운드(Detached)**에서 실행합니다.
		-it: 나중에 접속할 수 있도록 상호작용이 가능한 **터미널(Interactive + TTY)**을 유지시킵니다.
		--name ubuntu10: 컨테이너에 ubuntu10이라는 고유한 이름을 붙여줍니다.
		ubuntu:latest: 컨테이너를 만들 이미지입니다.

docker exec -it ubuntu10 /bin/bash
	명령어 분석
		docker exec: 실행 중인 컨테이너 내부에서 명령어를 실행합니다.
		-it: 키보드 입력을 가능하게 하고(-i), 터미널 화면을 제공(-t)하여 실제 셸처럼 상호작용할 수 있게 합니다.
		ubuntu10: 접속할 컨테이너의 이름입니다.
		/bin/bash: 컨테이너 안에서 실행할 프로그램입니다. 여기서는 Bash 셸을 실행하라는 의미입니다.

for i in {1..9}; do docker run -dit --name ubuntu${i} ubuntu:latest; done
	명령어 분석
		for i in {1..9}: 1부터 9까지 반복하는 반복문입니다. 변수 i에 숫자 1, 2, 3, ..., 9가 차례대로 들어갑니다.
		do ... done: 반복문이 실행될 실제 명령어 구간입니다.
		docker run -dit --name ubuntu${i} ubuntu:latest: 컨테이너를 생성하는 명령어입니다. 
			여기서 ${i} 부분은 반복할 때마다 현재 숫자(1, 2, 3...)로 바뀌어, ubuntu1, ubuntu2 와 같은 
			고유한 이름이 만들어집니다.

## 컨테이너 터미널
docker exec -it 7600fc4bd5a5 /bin/bash

apt update
apt upgrade
apt install apt-file
	apt-file의 역할
		가끔 ping이나 nslookup 같은 명령어를 실행하고 싶은데, 어떤 패키지를 설치해야 
		그 명령어를 쓸 수 있는지 모를 때가 있습니다.
		apt-file은 바로 그럴 때 사용하는 도구입니다. 특정 파일이나 명령어가 어떤 패키지에 
		포함되어 있는지 찾아주는 역할을 합니다.

apt-file update

apt-file search /bin/ping
	명령어는 /bin/ping이라는 파일이 어떤 패키지에 포함되어 있는지 검색
apt install iputils-ping

apt-file search /bin/nslookup
apt install bind9-dnsutils

apt install apache2
apt list apache2
	명령어는 apache2 패키지의 설치 상태와 사용 가능한 버전 정보를 보여줍니다

apt-file search /bin/systemctl
apt install systemctl
5
68

systemctl start apache2
	명령어는 apache2 웹 서버 서비스를 시작
systemctl status apache2
	명령어는 apache2 서비스의 현재 상태를 자세히 확인

hostname -i
172.17.0.4
root@129730f21ad2:/# exit
exit

## 호스트 터미널 
ubuntu@docker:~$ curl 172.17.0.4
docker ps -a
docker stop ubuntu9
docker rm ubuntu9

docker stop $(docker ps -aq)
	명령어는 내 컴퓨터에 있는 모든 컨테이너(실행 중이거나 멈춰있는 것 모두)를 
	한 번에 중지시키는 역할
docker rm  $(docker ps -aq)

docker ps
docker ps -a

docker run -dit -p 22222:22 --name ubuntu01 ubuntu:latest
docker exec ubuntu01 hostname -i

docker exec -it ubuntu01 /bin/bash
apt update
exit
ssh 172.17.0.2 -p 22222

docker rm -f ubuntu01
docker run -dit -p 22222:22 --rm  --name ubuntu01 ubuntu:latest
docker stop ubuntu01

docker network list
docker run -dit --network host --name ubuntu01 ubuntu:latest

docker images
docker rmi ubuntu
docker images

# 추가할 내용

### 1. Dockerfile: 나만의 이미지를 만드는 '레시피'
설명: docker exec로 컨테이너에 들어가 apt install을 하는 것은 편리한 테스트 방법이지만, 컨테이너를 삭제하면 작업한 내용이 모두 사라집니다. Dockerfile은 이런 설치 과정을 코드로 기록하여, 언제든 동일한 '나만의 이미지'를 만들 수 있게 해주는 레시피 파일입니다.

추가할 내용: Dockerfile을 작성하고 docker build 명령어로 이미지를 생성하는 과정을 별도의 섹션으로 정리하면 좋습니다. (이미 노트 후반부에 docker-nginx 예제로 잘 정리해두셨습니다!)

### 2. 볼륨(Volume): 데이터 영구적으로 저장하기
설명: 컨테이너는 '일회용품' 같아서 삭제하면 내부 데이터가 사라집니다. 데이터베이스 데이터나 사용자가 업로드한 파일처럼 영구적으로 보존해야 할 데이터는 볼륨을 사용해 컨테이너 외부의 컴퓨터에 저장해야 합니다.

추가할 내용: docker run 명령어의 -v 옵션에 대한 설명을 추가하면 좋습니다.


### 내 컴퓨터의 my-data 폴더를 컨테이너 안의 /app/data 폴더에 연결
docker run -v ~/my-data:/app/data ...

### 3. 도커 컴포즈(Docker Compose): 여러 컨테이너를 한번에 관리하기
설명: 웹 서버와 데이터베이스처럼, 여러 개의 컨테이너를 하나의 팀으로 묶어 동시에 실행하고 중지시키는 등 다중 컨테이너 애플리케이션을 쉽게 관리해주는 도구입니다. docker run 명령어를 여러 번 칠 필요 없이, docker-compose.yml 설계도 하나로 모든 것을 관리합니다.

추가할 내용: docker-compose.yml 파일의 기본 구조와 docker compose up, docker compose down 명령어에 대한 설명을 추가하면, 개별 컨테이너 관리에서 애플리케이션 전체 관리로 넘어가는 흐름을 보여줄 수 있습니다. (이 내용도 노트 후반부에 잘 정리되어 있습니다!)

### 4. 시스템 정리 (docker system prune)
설명: Docker를 사용하다 보면 중지된 컨테이너, 안 쓰는 이미지와 네트워크 등 불필요한 데이터가 계속 쌓입니다. 이들을 한 번에 깨끗하게 정리하는 매우 유용한 명령어입니다.


### 사용하지 않는 모든 도커 리소스(중지된 컨테이너, dangling 이미지 등)를 삭제
docker system prune

# 추가할 내용

# Docker 심화 명령어 및 활용 가이드 (수정 및 보완)
## 1. 컨테이너와 상호작용하기: attach vs exec
컨테이너에 접속하는 두 가지 방법은 매우 중요하며, 차이점을 이해해야 합니다.

docker attach ubuntu10

설명: 실행 중인 컨테이너의 **메인 프로세스(1번 프로세스)**에 그대로 접속합니다.

⚠️주의: 여기서 exit를 입력하면 메인 프로세스가 종료되므로 컨테이너 자체가 멈춥니다. 주로 컨테이너의 기본 출력을 실시간으로 모니터링할 때 사용합니다.

docker exec -it ubuntu10 /bin/bash

설명: 실행 중인 컨테이너 안에 새로운 /bin/bash 프로세스를 추가로 실행하여 접속합니다.

👍특징: 여기서 exit를 해도 새로 만든 프로세스만 종료될 뿐, 컨테이너는 계속 실행됩니다. 컨테이너를 디버깅하거나 내부에서 작업할 때 사용하는 가장 일반적이고 안전한 방법입니다.

## 2. 나만의 이미지 만들기 (3가지 방법 요약)
컨테이너의 변경사항을 이미지로 만드는 방법들입니다.

docker export/import: 컨테이너의 파일 시스템만 압축합니다. Docker의 설정 정보(명령어, 포트 등)는 모두 사라지므로 특수한 백업 용도 외에는 잘 사용하지 않습니다.

docker commit: 가장 간단하게 컨테이너의 현재 상태를 이미지로 저장합니다. 테스트나 개인적인 용도로 빠르게 이미지를 만들 때 유용합니다.

docker save/load: 이미지의 모든 정보(레이어, 히스토리)를 그대로 .tar 파일로 저장합니다. 인터넷이 안 되는 환경에 이미지를 옮길 때 사용합니다.

## 3. Docker Hub로 이미지 공유하기
commit으로 만든 이미지를 다른 사람이나 다른 서버와 공유하는 표준적인 절차입니다.

```
# 1. Docker Hub 로그인
docker login -u ksh00120

# 2. 이미지에 이름표 붙이기 (사용자명/이미지명:태그 형식)
docker tag ubuntu03 ksh00120/ubuntu03:latest

# 3. Docker Hub에 업로드
docker push ksh00120/ubuntu03:latest

# 4. (다른 컴퓨터에서) Docker Hub 이미지 다운로드 및 실행
docker pull ksh00120/ubuntu03:latest
docker run -dit --name ubuntu04 ksh00120/ubuntu03:latest
```

## 4. 컨테이너 생명주기 및 상태 관리
실행 중인 컨테이너를 관리하는 다양한 명령어입니다.

docker inspect ubuntu01: 컨테이너의 모든 상세 정보(IP 주소, 볼륨 경로, 네트워크 설정 등)를 JSON 형식으로 보여줍니다.

docker kill ubuntu02: 컨테이너를 정상 종료 신호 없이 즉시 강제 종료시킵니다. (stop은 안전 종료)

docker pause/unpause ubuntu03: 컨테이너의 모든 프로세스를 일시 정지시키거나 다시 재개합니다.

docker restart ubuntu03: 컨테이너를 재시작합니다.

docker diff wordpress: 컨테이너가 처음 생성된 이후 변경된(추가 A, 수정 C, 삭제 D) 파일 목록을 보여줍니다.

## 5. 컨테이너 실시간 모니터링
docker stats ubuntu01: 특정 컨테이너(또는 전체)의 CPU, 메모리, 네트워크 사용량을 실시간으로 보여줍니다.

docker top ubuntu01: 컨테이너 내부에서 실행 중인 프로세스 목록을 보여줍니다.

## 6. 워드프레스 예제 (네트워크 및 볼륨 활용)
--link는 오래된 방식입니다. 사용자 정의 네트워크를 만들어 컨테이너들이 서로 이름으로 통신하게 하고, 볼륨으로 데이터를 영구 저장하는 것이 현대적인 방식입니다.

```
# 1. 컨테이너 간 통신을 위한 전용 네트워크 생성
docker network create wordpress-net

# 2. 데이터베이스 컨테이너 실행 (볼륨 사용)
docker run -dit --name wordpressdb \
-e MYSQL_ROOT_PASSWORD=dkagh1. \
-e MYSQL_DATABASE=wordpress \
-v wordpressdb-data:/var/lib/mysql \
--network wordpress-net \
mysql

# 3. 워드프레스 컨테이너 실행 (네트워크 연결)
docker run -dit --name wordpress \
-e WORDPRESS_DB_HOST=wordpressdb \
-e WORDPRESS_DB_USER=root \
-e WORDPRESS_DB_PASSWORD=dkagh1. \
-p 80:80 \
--network wordpress-net \
wordpress
```

* 추가된 점: --network wordpress-net으로 두 컨테이너를 같은 네트워크에 연결하면, wordpress 컨테이너가 wordpressdb라는 호스트 이름으로 데이터베이스 컨테이너를 자동으로 찾을 수 있습니다. -v 옵션으로 데이터베이스 데이터를 안전하게 보존합니다.
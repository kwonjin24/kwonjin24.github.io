---
layout: default
title: 
parent: 9월 9일
nav_order: 2
---

# 2025년 9월 9일 교육 내용

A(U)-> G <- P

Terraform 함수 분석 노트 📝
replace(local.string_data.raw_tag_name, "/[^a-zA-Z0-9-]+/", "-")
1. replace 함수
역할: 문자열의 특정 부분을 찾아 다른 내용으로 교체합니다.

구조: 3가지 요소로 구성됩니다.

원본: local.string_data.raw_tag_name ( "WebServer / API-Tier / v1.2" )

찾을 패턴: /[^a-zA-Z0-9-]+/ (정규 표현식 규칙)

바꿀 내용: "-" (하이픈)

2. local. 접두사 (Prefix)
역할: 같은 파일 내의 locals { ... } 블록에 선언된 **'중간 계산용 변수'**를 사용할 때 붙이는 주소입니다.

비교: var. 접두사는 variables.tf 파일에 선언된 **'외부 입력 변수'**를 가리킵니다.

3. 정규 표현식 /[^a-zA-Z0-9-]+/
/ ... /: 정규 표현식이라는 특별한 문법의 시작과 끝을 알리는 신호입니다.

[^...]: 대괄호 안의 문자를 제외한 모든 문자와 일치시킵니다.

여기서는 '알파벳(a-z, A-Z), 숫자(0-9), 하이픈(-)'을 제외한 모든 문자를 찾습니다.

+: 바로 앞의 규칙([^...])에 해당하는 문자가 1개 이상 연속될 경우, 그것을 하나의 덩어리로 취급합니다.

예: / 처럼 여러 문자가 연속되어도 하나의 덩어리로 보고, - 하나로만 교체됩니다.


Terraform 함수 노트 📝
format 함수
역할: 문자열 '틀'에 순서대로 값을 채워 넣어 동적인 문자열을 만듭니다.

구조: format(틀, 값1, 값2, ...)

핵심 원리: 틀 안에 있는 빈칸들(%s, %d 등)이 뒤따라오는 값들로 순서대로 채워집니다. 값의 순서를 바꾸면 결과도 바뀝니다.

주요 사용처: 리소스에 일관된 이름 규칙을 적용할 때 (예: format("WebApp-%s-%s", var.env, var.region)) 아주 유용합니다.

네, 그럼요. join 함수도 깔끔하게 정리해서 메모장에 추가해 드릴게요.


Terraform 함수 노트 📝
join 함수
역할: 여러 문자열 조각이 담긴 리스트를 '접착제'를 사용해 하나의 긴 문자열로 합칩니다.

구조: join(접착제, 조각_리스트)

접착제: 각 조각 사이에 들어갈 문자열 (예: ", ")

조각_리스트: 합치고 싶은 문자열들이 담긴 리스트 (예: local.list_for_search)

핵심 원리: 리스트의 각 요소를 순서대로 꺼내 그 사이에 '접착제'를 붙여 연결합니다.

비교: 문자열을 잘라 리스트를 만드는 split 함수의 정반대 역할을 합니다.

Terraform 함수 노트 📝
lookup 함수
역할: 맵(map)에서 키(key)를 찾아 값을 조회할 때 사용하는 안전장치입니다. 🛡️

구조: lookup(맵, 찾을_키, 기본값)

맵: 검색 대상이 되는 맵 데이터 (예: local.server_specs)

찾을_키: 맵에서 찾고 싶은 값의 이름표 (예: "prod")

기본값: 찾을_키가 맵에 없을 경우 대신 반환할 값 (예: "t3.micro")

핵심 원리: 찾는 키가 있으면 해당 키의 값을 반환하고, 키가 없으면 에러를 발생시키는 대신 '기본값'을 반환하여 코드 실행이 중단되는 것을 막아줍니다

Terraform 함수 노트 📝
element 함수
역할: 리스트(list)에서 특정 위치(index)에 있는 값을 꺼냅니다.

구조: element(리스트, 위치)

리스트: 값을 꺼내올 대상 리스트 (예: local.availability_zones)

위치: 꺼내고 싶은 값의 순서 번호 (0부터 시작) (예: 1)

핵심 원리: 컴퓨터는 순서를 0부터 세기 시작합니다. (0 = 첫 번째, 1 = 두 번째, ...)

안전장치: 리스트의 크기를 벗어나는 위치를 요청하면, 에러 없이 리스트를 **순환(wrap-around)**하여 값을 반환합니다. (예: 크기가 3인 리스트에 3번을 요청하면 0번을 반환) 🎡


Terraform 함수 노트 📝
keys & values 함수
역할: 맵(map)의 내부를 들여다보는 한 쌍의 함수입니다.

keys: 맵의 **'이름표'**들만 모아서 리스트로 반환합니다.

values: 맵의 **'내용물'**들만 모아서 리스트로 반환합니다.

구조:

keys(맵)

values(맵)

핵심 원리: 두 함수를 함께 사용하면 맵의 전체 구조를 파악하고, for 표현식 등과 조합하여 데이터를 다양하게 활용할 수 있습니다.


Terraform 함수 노트 📝
merge 함수
역할: 여러 개의 맵(map)을 하나로 합칩니다.

구조: merge(맵1, 맵2, ...)

핵심 원리: 여러 맵에 동일한 키(key)가 있을 경우, **'나중에 온 값이 이긴다(last one wins)'**는 규칙을 따릅니다. 즉, 뒤에 있는 맵의 값으로 덮어쓰기 됩니다.

주요 사용처: 공통 설정(기본값)을 담은 맵에 특정 리소스에만 적용할 개별 설정을 덮어쓰는 방식으로 유용하게 사용됩니다.


Terraform 함수 노트 📝
flatten 함수
역할: 중첩된 리스트(리스트 안의 리스트)를 하나의 평평한 1차원 리스트로 만들어줍니다.

구조: flatten(중첩_리스트)

핵심 원리: 여러 개의 작은 주머니에 나뉘어 담긴 내용물을 하나의 큰 주머니에 모두 쏟아붓는 것처럼, 복잡한 데이터 구조를 단순화합니다.

주요 사용처: 복잡한 for 표현식의 결과물을 for_each 구문 등에서 사용하기 좋은 단일 리스트로 변환할 때 유용합니다.


Terraform 함수 노트 📝
length 함수
역할: 리스트, 맵, 문자열에 포함된 **항목의 개수(길이)**를 숫자로 반환합니다.

구조: length(대상)

핵심 원리:

리스트: 항목의 개수를 셉니다.

맵: 키-값 쌍의 개수를 셉니다.

문자열: 글자의 개수를 셉니다.

주요 사용처: count나 for_each 메타-인수에서 리소스 생성 개수를 동적으로 결정하는 등 다양한 로직의 기반으로 사용됩니다.


Terraform 함수 노트 📝
concat 함수
역할: 여러 개의 리스트를 순서대로 이어 붙여 하나의 더 긴 리스트로 만듭니다. ✏️

구조: concat(리스트1, 리스트2, ...)

핵심 원리: 리스트 안의 내용물(중복 여부 등)은 신경 쓰지 않고, 주어진 순서대로 모든 항목을 포함한 새로운 리스트를 생성합니다.


Terraform 함수 노트 📝
tonumber 함수
역할: 따옴표로 감싸인 숫자 모양의 **글자(String)**를 따옴표가 없는 **진짜 숫자(Number)**로 타입을 변환합니다.

구조: tonumber(문자열)

핵심 원리: 테라폼은 "8080"(글자)과 8080(숫자)을 엄격하게 구분합니다. tonumber는 이 둘 사이의 타입을 바꿔주는 역할을 합니다.

주요 사용처: 보안 그룹 규칙의 포트 번호처럼 반드시 숫자 타입을 요구하는 인자에 문자열 형태의 값을 전달해야 할 때 에러를 방지하기 위해 사용합니다.


Terraform 함수 노트 📝
abs 함수
역할: 숫자의 **'절댓값'**을 구합니다. 즉, 숫자의 부호(-)를 제거하고 항상 양수 값을 반환합니다.

구조: abs(숫자)

핵심 원리: 값의 '방향'(음수/양수)은 무시하고, 원점(0)으로부터의 '거리' 또는 '크기'만 알고 싶을 때 사용합니다.

주요 사용처: 두 값의 차이를 계산하는 등, 결과값의 부호가 중요하지 않은 수학적 연산에 유용합니다


Terraform 함수 노트 📝
max 함수
역할: 주어진 여러 숫자들 중에서 **'최댓값'**을 찾아 반환합니다.

구조: max(숫자1, 숫자2, ...)

핵심 문법 - ... 기호: 리스트나 튜플 같은 데이터 묶음(상자 🎁)을 함수에 전달할 때, ... 기호를 변수 뒤에 붙여주면 상자를 열어서 내용물(개별 요소)만 꺼내주는 역할을 합니다.

예시:

max(local.numeric_data.numbers...)는

max(-12.5, 4, 99)와 동일하게 동작하여 99를 반환합니다.

주의: ... 기호 없이 리스트 자체를 전달하면 (max(local.numeric_data.numbers)), 함수가 숫자 묶음을 처리할 수 없다는 에러가 발생합니다.


Terraform 함수 노트 📝
pow 함수
역할: 거듭제곱을 계산합니다. (밑 
지수
 )

구조: pow(밑, 지수)

밑: 여러 번 곱할 대상이 되는 숫자.

지수: 밑을 곱할 횟수.

핵심 원리: 인자의 순서가 매우 중요합니다. pow(2, 10) (2의 10승)과 pow(10, 2) (10의 2승)은 완전히 다른 결과를 반환합니다.


erraform 함수 노트 📝
anytrue 함수
역할: true/false 값들이 담긴 리스트에서 하나라도 true이면 true를 반환하는 논리 함수입니다.

구조: anytrue(불리언_리스트)

핵심 원리: 리스트의 모든 요소를 확인하여 true가 하나라도 있는지 검사합니다. 모든 요소가 false일 때만 false를 반환합니다.

주요 사용처: 여러 조건 중 '하나만 만족하면 되는' 논리를 구현할 때 유용합니다. (예: 여러 기능 플래그 중 하나라도 켜져 있으면 리소스 생성)


Terraform 함수 노트 📝
file 함수
역할: 지정된 파일의 내용을 통째로 읽어서 문자열로 반환합니다. 📜

구조: file(파일_경로)

핵심 문법 - ${path.module}: 테라폼 코드 파일이 위치한 **'현재 폴더'**를 의미하는 특수 변수입니다. 파일 경로를 지정할 때 기준점으로 자주 사용됩니다.

주요 사용처: 외부 스크립트 파일이나 간단한 설정 파일을 테라폼 코드 안으로 불러올 때 사용합니다.


Terraform 함수: templatefile
역할: 외부 파일의 내용을 읽어오고, 파일 안에 있는 변수를 우리가 지정한 값으로 채워 넣어 반환합니다.

구조: templatefile(템플릿_경로, 변수_맵).

핵심 문법: file 함수와 마찬가지로 ${path.module}을 사용해 현재 폴더를 기준으로 경로를 지정할 수 있습니다. 변수들은 {변수이름 = 값, ...} 형식의 맵으로 전달합니다.

주요 사용처: EC2 user_data 스크립트처럼 내용의 일부가 테라폼 변수에 따라 동적으로 변경되어야 할 때 유용하게 사용됩니다.

